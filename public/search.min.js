(()=>{(function(){let h=document.getElementById("search-container").classList,u=document.getElementById("search-results"),m=document.getElementById("search-results-loading"),p=document.getElementById("search-query");document.getElementById("toggle_search").addEventListener("click",()=>{h.contains("hidden")?h.remove("hidden"):h.add("hidden")});let g=[],f=null;fetch("/index.json",{method:"GET"}).then(t=>t.json()).then(t=>{g=t,f=lunr(function(){["permalink","title","contents","tags","categories"].forEach(e=>this.field(e)),this.metadataWhitelist=["position"],g.forEach((e,s)=>{this.add({id:s,permalink:e.permalink,title:e.title,contents:e.contents,tags:e.tags?e.tags.join(" | "):"",categories:e.categories?e.categories.join(" | "):""})})}),m.parentNode.removeChild(m),p.removeAttribute("disabled")});let o=(t,e)=>`<${t}>${e}</${t}>`,d=(t,e,s)=>{let n=[[0,0]];Object.keys(s).forEach(i=>{let a=(s[i][e]||{}).position;n=n.concat(a||[])});let r=70,c=t.length,b=n.sort((i,a)=>i[0]<a[0]).slice(Math.max(0,n.length-10));for(let[i,a]of b){let j=c-(i+a),l=t.substring(i+a);j>r*2&&(l=`${l.substring(0,r)}... `,c<t.length&&(l+=t.substring(c-r)));let $=t.substring(i,i+a);t=t.substring(0,i)+(i>0||a>0?o("mark",$):$)+l,c=i}return t},E=(t,e,s)=>d(t.join(" | "),e,s).split(" | ").join(", "),y=t=>{let e=g[Number(t.ref)],s=t.matchData.metadata,n=[o("h1",d(e.title,"title",s))];return e.tags&&e.tags.length>0&&n.push(o("p",`Tags: ${E(e.tags,"tags",s)}`)),e.categories&&e.categories.length>0&&n.push(o("p",`Categories: ${E(e.categories,"categories",s)}`)),n=n.concat(d(e.contents,"contents",s).split(`
`).map(r=>o("p",r))),`<a href="${e.permalink}">${n.join("")}</a>`};p.addEventListener("keyup",t=>{let e=t.target.value,s=[];if(e&&e.length>2)try{s=f.search(e)}catch(n){s.innerHTML=`Error: ${n.message}`}if(s.length===0){u.innerHTML='<p class="no-results">No results</p>';return}u.innerHTML=`<ul>${s.map(n=>`<li>${y(n)}</li>`).join("")}</ul>`})})();})();
